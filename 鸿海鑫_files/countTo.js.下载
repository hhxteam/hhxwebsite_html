$.fn.countTo=function(options){options=options||{};return $(this).each(function(){var settings=$.extend({},$.fn.countTo.defaults,{from:$(this).data("from"),to:$(this).data("to"),speed:$(this).data("speed"),refreshInterval:$(this).data("refresh-interval"),decimals:$(this).data("decimals")},options);var loops=Math.ceil(settings.speed/settings.refreshInterval),increment=(settings.to-settings.from)/loops;var self=this,$self=$(this),loopCount=0,value=settings.from,data=$self.data("countTo")||{};$self.data("countTo",data);if(data.interval){clearInterval(data.interval)}data.interval=setInterval(updateTimer,settings.refreshInterval);render(value);function updateTimer(){value+=increment;loopCount++;render(value);if(typeof(settings.onUpdate)=="function"){settings.onUpdate.call(self,value)}if(loopCount>=loops){$self.removeData("countTo");clearInterval(data.interval);value=settings.to;if(typeof(settings.onCompvare)=="function"){settings.onCompvare.call(self,value)}}}function render(value){var formattedValue=settings.formatter.call(self,value,settings);$self.html(toThousands(formattedValue))}})};$.fn.countTo.defaults={from:0,to:0,speed:1000,refreshInterval:100,decimals:0,formatter:formatter,onUpdate:null,onCompvare:null};function toThousands(num){num=(num||0).toString();var number=0,floatNum="",intNum="";if(num.indexOf(".")>0){number=num.indexOf(".");floatNum=num.substr(number);intNum=num.substring(0,number)}else{intNum=num}var result=[],counter=0;intNum=intNum.split("");for(var i=intNum.length-1;i>=0;i--){counter++;result.unshift(intNum[i]);if(!(counter%3)&&i!=0){result.unshift(",")}}return result.join("")+floatNum||""}function formatter(value,settings){return value.toFixed(settings.decimals)};